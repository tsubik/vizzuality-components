{"version":3,"file":"index.esm.js","sources":["../../src/components/timestep/index.js"],"sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\n// components\nimport Icon from 'components/icon';\nimport Slider from 'components/slider';\n\n// styles\nimport './styles.scss';\n\nclass Timestep extends PureComponent {\n  static propTypes = {\n    customClass: PropTypes.string,\n    range: PropTypes.bool,\n    pushable: PropTypes.oneOfType([PropTypes.bool, PropTypes.number]),\n    canPlay: PropTypes.bool,\n    min: PropTypes.number.isRequired,\n    minAbs: PropTypes.number,\n    max: PropTypes.number.isRequired,\n    maxAbs: PropTypes.number,\n    start: PropTypes.number.isRequired,\n    end: PropTypes.number.isRequired,\n    trim: PropTypes.number,\n    marks: PropTypes.shape({}).isRequired,\n    step: PropTypes.number,\n    speed: PropTypes.number,\n    loop: PropTypes.bool,\n    formatValue: PropTypes.func.isRequired,\n\n    trackStyle: PropTypes.oneOfType([PropTypes.array, PropTypes.shape({})]),\n    railStyle: PropTypes.shape({}),\n    handleStyle: PropTypes.shape({}),\n\n    playing: PropTypes.bool,\n    PlayButton: PropTypes.node,\n\n    handleOnChange: PropTypes.func,\n    handleOnAfterChange: PropTypes.func,\n    handleOnPlay: PropTypes.func,\n  };\n\n  static defaultProps = {\n    customClass: null,\n    range: true,\n    pushable: 0,\n    canPlay: false,\n\n    trim: null,\n\n    minAbs: -Infinity,\n    maxAbs: Infinity,\n\n    step: 1,\n    speed: 100,\n    loop: false,\n\n    trackStyle: {\n      backgroundColor: '#c32d7b',\n      borderRadius: '0px',\n    },\n    railStyle: { backgroundColor: '#d9d9d9' },\n    handleStyle: {\n      backgroundColor: '#c32d7b',\n      borderRadius: '10px',\n      boxShadow: '0 1px 2px 0 rgba(0, 0, 0, 0.29)',\n      border: '0px',\n      zIndex: 2,\n    },\n\n    playing: undefined,\n    PlayButton: null,\n\n    handleOnChange: null,\n    handleOnAfterChange: null,\n    handleOnPlay: null,\n  };\n\n  constructor(props) {\n    super(props);\n    const { playing, start, end, trim, minAbs, maxAbs } = this.props;\n\n    this.state = {\n      playing,\n      start: start <= minAbs ? minAbs : start,\n      end: end >= maxAbs ? maxAbs : end,\n      trim: trim >= maxAbs ? maxAbs : trim,\n    };\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { playing: statePlaying, start: stateStart, end: stateEnd, trim: stateTrim } = this.state;\n    const {\n      playing: prevStatePlaying,\n      start: prevStateStart,\n      end: prevStateEnd,\n      trim: prevStateTrim,\n    } = prevState;\n\n    const { playing, start, end, trim, minAbs, maxAbs } = this.props;\n    const {\n      playing: prevPropsPlaying,\n      start: prevPropsStart,\n      end: prevPropsEnd,\n      trim: prevPropsTrim,\n      minAbs: prevPropsMinAbs,\n      maxAbs: prevPropsMaxAbs,\n    } = prevProps;\n\n    if (playing !== prevPropsPlaying) {\n      this.setState({ playing }); // eslint-disable-line\n    }\n\n    if (statePlaying && statePlaying !== prevStatePlaying) {\n      this.startTimeline();\n    } else if (!statePlaying && statePlaying !== prevStatePlaying) {\n      this.stopTimeline();\n    } else if (statePlaying && stateEnd !== prevStateEnd) {\n      this.incrementTimeline();\n    }\n\n    if (start !== prevPropsStart && start !== stateStart && prevStateStart === stateStart) {\n      this.setState({\n        // eslint-disable-line\n        start: start <= minAbs ? minAbs : start,\n        end: trim >= maxAbs ? maxAbs : trim,\n      });\n    }\n\n    if (end !== prevPropsEnd && end !== stateEnd && prevStateEnd === stateEnd) {\n      this.setState({\n        // eslint-disable-line\n        end: end >= maxAbs ? maxAbs : end,\n      });\n    }\n\n    if (trim !== prevPropsTrim && trim !== stateTrim && prevStateTrim === stateTrim) {\n      this.setState({\n        // eslint-disable-line\n        trim,\n        end: trim >= maxAbs ? maxAbs : trim,\n      });\n    }\n\n    if (minAbs !== prevPropsMinAbs || maxAbs !== prevPropsMaxAbs) {\n      this.setState({\n        // eslint-disable-line\n        start: start <= minAbs ? minAbs : start,\n        trim: trim >= maxAbs ? maxAbs : trim,\n        end: end >= maxAbs ? maxAbs : end,\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.interval) this.stopTimeline();\n  }\n\n  getValue() {\n    const { start, end, trim } = this.state;\n    const { range } = this.props;\n\n    if (range) {\n      return [start, end, trim];\n    }\n\n    return end;\n  }\n\n  getTrackStyle() {\n    const { start, end, trim } = this.state;\n    const { trackStyle } = this.props;\n\n    if (Array.isArray(trackStyle)) {\n      const diff = end - start;\n      const diff2 = trim - end;\n      let stringArr = [];\n\n      return trackStyle.map((t, i) => {\n        const { gradient } = t;\n\n        if (gradient) {\n          const stringKeys = Object.keys(gradient);\n\n          // It could be better, no more neurons\n          if (i === 0) {\n            stringArr = stringKeys\n              .filter((g, j) => {\n                const next = stringKeys[j + 1] || g;\n                const di = start - (g + next);\n\n                return g >= di && g <= end;\n              })\n\n              .map((g, j) => {\n                const first = j === 0;\n                const perc = ((g - start) / diff) * 100;\n                const index = stringKeys.findIndex((ix) => ix === g);\n\n                if (first) {\n                  return `${gradient[g]}`;\n                }\n                return `${gradient[stringKeys[index - 1]]} ${perc}%, ${gradient[g]} ${perc}%`;\n              });\n          }\n\n          // It could be better, no more neurons\n          if (i === 1) {\n            stringArr = stringKeys\n              .filter((g, j) => {\n                const last = stringKeys[j - 1] || g;\n                const di = end - (g - last);\n\n                return g > di && g <= trim;\n              })\n\n              .map((g, j) => {\n                const first = j === 0;\n                const perc = ((g - end) / diff2) * 100;\n                const index = stringKeys.findIndex((ix) => ix === g);\n\n                if (first) {\n                  return `${gradient[g]}`;\n                }\n\n                return `${gradient[stringKeys[index - 1]]} ${perc}%, ${gradient[g]} ${perc}%`;\n              });\n          }\n\n          return {\n            ...t,\n            background:\n              stringArr.length > 1\n                ? `linear-gradient(to right, ${stringArr.join(',')})`\n                : stringArr.toString(),\n          };\n        }\n\n        return t;\n      });\n    }\n\n    return trackStyle;\n  }\n\n  startTimeline = () => {\n    const { start, end, trim } = this.state;\n    if (end < trim) {\n      this.incrementTimeline();\n    } else if (end >= trim) {\n      this.setState({ end: start }, () => {\n        this.incrementTimeline();\n      });\n    }\n  };\n\n  stopTimeline = () => {\n    clearInterval(this.interval);\n  };\n\n  incrementTimeline = () => {\n    const { start, end, trim } = this.state;\n    const { speed, step, range, max, maxAbs } = this.props;\n\n    const maxCurrent = max >= maxAbs ? maxAbs : max;\n\n    this.interval = setTimeout(() => {\n      const newEnd = end + step;\n\n      if ((newEnd > trim && range) || (!range && newEnd >= maxCurrent)) {\n        this.handleResetTimeline();\n      } else {\n        this.handleOnChange([start, newEnd, trim]);\n        this.handleOnAfterChange([start, newEnd, trim]);\n      }\n    }, speed);\n  };\n\n  handleResetTimeline = () => {\n    const { loop } = this.props;\n    const { trim } = this.state;\n    this.stopTimeline();\n\n    if (loop) {\n      this.startTimeline();\n    } else {\n      this.setState({ playing: false, end: trim });\n    }\n  };\n\n  checkRange = (range) => {\n    const { playing, start, end, trim } = this.state;\n    const { min: minProp, max: maxProp, minAbs, maxAbs, minGap, maxGap } = this.props;\n\n    if (!Array.isArray(range)) {\n      return [start, range, trim];\n    }\n\n    let min = range[0] <= minAbs ? minAbs : range[0];\n    let max = range[2] >= maxAbs ? maxAbs : range[2];\n\n    // If start is different from current state\n    if (!playing && range[0] !== start) {\n      if (minGap && max - min < minGap) {\n        if (max === maxAbs || max === maxProp) {\n          min = max - minGap;\n        } else {\n          max = min + minGap;\n        }\n      }\n\n      if (maxGap) {\n        max = max - min > maxGap ? min + maxGap : max;\n      }\n\n      return [min, max, max];\n    }\n\n    // If end is different from trim, and trim is different from current state\n    if (!playing && range[1] !== range[2] && trim !== range[2]) {\n      if (minGap && max - (min + minGap) < 0) {\n        if (min === minAbs || min === minProp) {\n          max = min + minGap;\n        } else {\n          min = max - minGap;\n        }\n      }\n\n      if (maxGap) {\n        min = max - (min + maxGap) > 0 ? max - maxGap : min;\n      }\n\n      return [min, max, max];\n    }\n\n    // If end is different from trim, and end is different from current state\n    if (!playing && range[1] !== range[2] && end !== range[1]) {\n      max = range[1] >= maxAbs ? maxAbs : range[1];\n\n      if (minGap && max - (min + minGap) < 0) {\n        if (min === minAbs || min === minProp) {\n          max = min + minGap;\n        } else {\n          min = max - minGap;\n        }\n      }\n\n      if (maxGap) {\n        min = max - (min + maxGap) > 0 ? max - maxGap : min;\n      }\n\n      return [min, max, max];\n    }\n\n    // If end is different from trim, and trim is different from current state\n    if (!playing && trim !== range[0]) {\n      if (minGap && max - (min + minGap) < 0) {\n        if (min === minAbs || min === minProp) {\n          max = min + minGap;\n        } else {\n          min = max - minGap;\n        }\n      }\n\n      if (maxGap) {\n        min = max - (min + maxGap) > 0 ? max - maxGap : min;\n      }\n\n      return [min, max, max];\n    }\n\n    return range;\n  };\n\n  handleOnChange = (range) => {\n    const { handleOnChange } = this.props;\n    const newRange = this.checkRange(range);\n\n    this.setState({\n      start: newRange[0],\n      end: newRange[1],\n      trim: newRange[2],\n    });\n\n    if (handleOnChange) handleOnChange(newRange);\n  };\n\n  /* eslint-disable-next-line */\n  handleOnAfterChange = (range) => {\n    const { handleOnAfterChange } = this.props;\n    const newRange = this.checkRange(range);\n\n    if (handleOnAfterChange) handleOnAfterChange(newRange);\n  };\n\n  handleTogglePlay = () => {\n    const { handleOnPlay } = this.props;\n    const { playing: statePlaying } = this.state;\n\n    const p = !statePlaying;\n\n    this.setState({ playing: p });\n\n    if (handleOnPlay) handleOnPlay(p);\n  };\n\n  renderPlay() {\n    const { playing: statePlaying } = this.state;\n\n    const iconStatus = classnames({\n      'icon-pause': statePlaying,\n      'icon-play': !statePlaying,\n    });\n\n    return (\n      <button\n        type=\"button\"\n        styleName=\"player-btn\"\n        className={classnames({\n          '-playing': statePlaying,\n        })}\n        onClick={this.handleTogglePlay}\n      >\n        <Icon name={iconStatus} />\n      </button>\n    );\n  }\n\n  render() {\n    const {\n      min,\n      max,\n      marks,\n      formatValue,\n      step,\n      canPlay,\n      customClass,\n      railStyle,\n      handleStyle,\n      range,\n      pushable,\n      PlayButton,\n    } = this.props;\n\n    const { playing } = this.state;\n\n    return (\n      <div styleName=\"c-timestep\" className={customClass}>\n        {canPlay && !PlayButton && this.renderPlay()}\n        {canPlay && !!PlayButton && PlayButton}\n\n        <div styleName={classnames('timestep-slider', { 'can-play': canPlay })}>\n          <Slider\n            range={range}\n            marks={marks}\n            disabled={playing}\n            min={min}\n            max={max}\n            value={this.getValue()}\n            step={step}\n            formatValue={formatValue}\n            railStyle={railStyle}\n            trackStyle={this.getTrackStyle()}\n            handleStyle={handleStyle}\n            showTooltip={(index) => playing && index === 1}\n            pushable={pushable}\n            onChange={this.handleOnChange}\n            onAfterChange={this.handleOnAfterChange}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Timestep;\n"],"names":["Timestep","props","state","start","end","trim","incrementTimeline","setState","clearInterval","interval","speed","step","range","max","maxAbs","maxCurrent","setTimeout","newEnd","handleResetTimeline","handleOnChange","handleOnAfterChange","loop","stopTimeline","startTimeline","playing","minProp","min","maxProp","minAbs","minGap","maxGap","Array","isArray","newRange","checkRange","handleOnPlay","statePlaying","p","prevProps","prevState","stateStart","stateEnd","stateTrim","prevStatePlaying","prevStateStart","prevStateEnd","prevStateTrim","prevPropsPlaying","prevPropsStart","prevPropsEnd","prevPropsTrim","prevPropsMinAbs","prevPropsMaxAbs","trackStyle","diff","diff2","stringArr","map","t","i","gradient","stringKeys","Object","keys","filter","g","j","next","di","first","perc","index","findIndex","ix","last","background","length","join","toString","iconStatus","classnames","handleTogglePlay","marks","formatValue","canPlay","customClass","railStyle","handleStyle","pushable","PlayButton","renderPlay","getValue","getTrackStyle","PureComponent","PropTypes","string","bool","oneOfType","number","isRequired","shape","func","array","node","Infinity","backgroundColor","borderRadius","boxShadow","border","zIndex","undefined"],"mappings":"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"}