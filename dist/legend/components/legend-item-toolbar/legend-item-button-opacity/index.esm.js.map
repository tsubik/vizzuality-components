{"version":3,"file":"index.esm.js","sources":["../../../../../src/components/legend/components/legend-item-toolbar/legend-item-button-opacity/index.js"],"sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport Icon from 'components/icon';\nimport Tooltip from 'components/tooltip';\nimport LegendOpacityTooltip from './legend-item-button-opacity-tooltip';\nimport styles from '../styles-button.scss';\n\nclass LegendItemButtonOpacity extends PureComponent {\n  static propTypes = {\n    layers: PropTypes.arrayOf(PropTypes.shape({})),\n    activeLayer: PropTypes.shape({}),\n    visibility: PropTypes.bool,\n    tooltipOpened: PropTypes.bool,\n    icon: PropTypes.string,\n    className: PropTypes.string,\n    focusStyle: PropTypes.shape({}),\n    defaultStyle: PropTypes.shape({}),\n    enabledStyle: PropTypes.shape({}),\n    disabledStyle: PropTypes.shape({}),\n    tooltipText: PropTypes.string,\n    scrolling: PropTypes.bool,\n\n    onChangeOpacity: PropTypes.func,\n    onTooltipVisibilityChange: PropTypes.func,\n  };\n\n  static defaultProps = {\n    layers: [],\n    activeLayer: {},\n    visibility: true,\n    icon: '',\n    className: '',\n    focusStyle: {},\n    defaultStyle: {},\n    enabledStyle: {},\n    disabledStyle: {},\n    tooltipOpened: false,\n    tooltipText: '',\n    scrolling: false,\n\n    onChangeOpacity: () => {},\n    onTooltipVisibilityChange: () => {},\n  };\n\n  state = {\n    visibilityHover: false,\n    visibilityClick: false,\n  };\n\n  componentWillReceiveProps(nextProps) {\n    const { scrolling } = nextProps;\n\n    if (scrolling) {\n      this.onTooltipVisibilityChange(false);\n    }\n  }\n\n  onTooltipVisibilityChange = (v) => {\n    const { visibility, onTooltipVisibilityChange } = this.props;\n\n    if (visibility) {\n      this.setState({\n        visibilityHover: false,\n        visibilityClick: v,\n      });\n\n      onTooltipVisibilityChange(v);\n    }\n  };\n\n  setHoverText = (tooltipText, opacity, visibility) => {\n    if (tooltipText) return tooltipText;\n\n    if (!visibility) return 'Opacity (disabled)';\n\n    return `Opacity ${typeof opacity !== 'undefined' ? `(${Math.round(opacity * 100)}%)` : ''}`;\n  };\n\n  render() {\n    const {\n      layers,\n      visibility,\n      activeLayer,\n      tooltipOpened,\n      icon,\n      className,\n      enabledStyle,\n      defaultStyle,\n      disabledStyle,\n      focusStyle,\n      tooltipText,\n      scrolling,\n      onChangeOpacity,\n      ...rest\n    } = this.props;\n\n    const { visibilityClick, visibilityHover } = this.state;\n    const { opacity } = activeLayer;\n    let iconStyle = visibility ? defaultStyle : disabledStyle;\n    if (visibility && (visibilityHover || visibilityClick)) {\n      iconStyle = focusStyle;\n    }\n    if (visibility && opacity < 1) iconStyle = enabledStyle;\n\n    return (\n      <Tooltip\n        overlay={\n          visibility && (\n            <LegendOpacityTooltip\n              layers={layers}\n              activeLayer={activeLayer}\n              onChangeOpacity={onChangeOpacity}\n              {...rest}\n            />\n          )\n        }\n        visible={visibility && visibilityClick}\n        overlayClassName={`c-rc-tooltip ${classnames({ '-default': visibility })} ${\n          className || ''\n        }`}\n        placement=\"top\"\n        trigger={['click']}\n        onVisibleChange={this.onTooltipVisibilityChange}\n        destroyTooltipOnHide\n      >\n        <Tooltip\n          visible={visibilityHover && !visibilityClick}\n          overlay={this.setHoverText(tooltipText, opacity, visibility)}\n          overlayClassName=\"c-rc-tooltip -default\"\n          placement=\"top\"\n          trigger={tooltipOpened ? '' : 'hover'}\n          onVisibleChange={(v) => this.setState({ visibilityHover: v })}\n          destroyTooltipOnHide\n          style={styles.tooltip}\n        >\n          <button\n            type=\"button\"\n            styleName={`c-legend-button opacity ${classnames({ '-disabled': !visibility })}`}\n            aria-label=\"Change opacity\"\n          >\n            <Icon name={icon || 'icon-opacity'} className=\"-small\" style={iconStyle} />\n          </button>\n        </Tooltip>\n      </Tooltip>\n    );\n  }\n}\n\nexport default LegendItemButtonOpacity;\n"],"names":["LegendItemButtonOpacity","visibilityHover","visibilityClick","v","props","visibility","onTooltipVisibilityChange","setState","tooltipText","opacity","Math","round","nextProps","scrolling","layers","activeLayer","tooltipOpened","icon","className","enabledStyle","defaultStyle","disabledStyle","focusStyle","onChangeOpacity","rest","state","iconStyle","classnames","setHoverText","styles","tooltip","PureComponent","PropTypes","arrayOf","shape","bool","string","func"],"mappings":"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"}