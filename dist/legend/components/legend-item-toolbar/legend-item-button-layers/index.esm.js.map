{"version":3,"file":"index.esm.js","sources":["../../../../../src/components/legend/components/legend-item-toolbar/legend-item-button-layers/index.js"],"sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport sortBy from 'lodash/sortBy';\nimport Icon from 'components/icon';\nimport Tooltip from 'components/tooltip';\nimport LegendLayersTooltip from './legend-item-button-layers-tooltip';\nimport '../styles-button.scss';\n\nclass LegendItemButtonLayers extends PureComponent {\n  static propTypes = {\n    layers: PropTypes.array,\n    activeLayer: PropTypes.object,\n    icon: PropTypes.string,\n    focusStyle: PropTypes.object,\n    defaultStyle: PropTypes.object,\n    tooltipText: PropTypes.string,\n    tooltipOpened: PropTypes.bool,\n    scrolling: PropTypes.bool,\n\n    onChangeLayer: PropTypes.func,\n    onTooltipVisibilityChange: PropTypes.func,\n  };\n\n  static defaultProps = {\n    layers: [],\n    activeLayer: {},\n    icon: '',\n    focusStyle: {},\n    defaultStyle: {},\n    tooltipOpened: false,\n    tooltipText: null,\n    scrolling: false,\n\n    onChangeLayer: () => {},\n    onTooltipVisibilityChange: () => {},\n  };\n\n  state = {\n    visibilityHover: false,\n    visibilityClick: false,\n    multiLayersActive: this.props.i === 0 && this.props.layers.length > 1,\n  };\n\n  componentWillReceiveProps(nextProps) {\n    const { scrolling, i: prevIndex } = this.props;\n    const { i: nextIndex } = nextProps;\n\n    if (scrolling || prevIndex !== nextIndex) {\n      this.onTooltipVisibilityChange(false);\n    }\n  }\n\n  onTooltipVisibilityChange = (visibility) => {\n    const { onTooltipVisibilityChange } = this.props;\n    const { multiLayersActive } = this.state;\n\n    this.setState({\n      visibilityHover: false,\n      visibilityClick: visibility,\n      ...(multiLayersActive && {\n        multiLayersActive: false,\n      }),\n    });\n\n    onTooltipVisibilityChange(visibility);\n  };\n\n  /**\n   * HELPERS\n   * - getTimelineLayers\n   */\n  getTimelineLayers = () => {\n    const { layers } = this.props;\n\n    return sortBy(\n      layers.filter((l) => l.layerConfig.timeline),\n      (l) => l.layerConfig.order\n    );\n  };\n\n  render() {\n    const {\n      layers,\n      activeLayer,\n      icon,\n      focusStyle,\n      defaultStyle,\n      tooltipText,\n      onChangeLayer,\n      tooltipOpened,\n    } = this.props;\n    const { visibilityClick, visibilityHover, multiLayersActive } = this.state;\n    const timelineLayers = this.getTimelineLayers();\n\n    if (layers.length === 1 || timelineLayers.length) {\n      return null;\n    }\n\n    return (\n      <Tooltip\n        overlay={\n          <LegendLayersTooltip\n            layers={layers}\n            activeLayer={activeLayer}\n            onChangeLayer={onChangeLayer}\n          />\n        }\n        overlayClassName=\"c-rc-tooltip -default -layers\"\n        placement=\"top\"\n        trigger={['click']}\n        visible={visibilityClick}\n        onVisibleChange={this.onTooltipVisibilityChange}\n        destroyTooltipOnHide\n      >\n        <Tooltip\n          visible={multiLayersActive || (!visibilityClick && visibilityHover)}\n          overlay={tooltipText || `${layers.length} layers`}\n          overlayClassName=\"c-rc-tooltip -default\"\n          placement=\"top\"\n          trigger={tooltipOpened ? '' : 'hover'}\n          onVisibleChange={(visibility) =>\n            this.setState({ visibilityHover: visibility, multiLayersActive: false })\n          }\n          destroyTooltipOnHide\n        >\n          <button type=\"button\" styleName=\"c-legend-button layers\" aria-label=\"Select other layer\">\n            <Icon\n              name={icon || 'icon-layers'}\n              className=\"-small\"\n              style={visibilityHover || visibilityClick ? focusStyle : defaultStyle}\n            />\n          </button>\n        </Tooltip>\n      </Tooltip>\n    );\n  }\n}\n\nexport default LegendItemButtonLayers;\n"],"names":["LegendItemButtonLayers","visibilityHover","visibilityClick","multiLayersActive","props","i","layers","length","visibility","onTooltipVisibilityChange","state","setState","sortBy","filter","l","layerConfig","timeline","order","nextProps","scrolling","prevIndex","nextIndex","activeLayer","icon","focusStyle","defaultStyle","tooltipText","onChangeLayer","tooltipOpened","timelineLayers","getTimelineLayers","PureComponent","PropTypes","array","object","string","bool","func"],"mappings":"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"}