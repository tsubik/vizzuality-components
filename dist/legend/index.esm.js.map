{"version":3,"file":"index.esm.js","sources":["../../src/components/legend/index.js"],"sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport arrayMove from 'array-move';\n\n// Components\nimport Icon from 'components/icon';\nimport LegendList from './components/legend-list';\n\nimport './styles.scss';\n\nclass Legend extends PureComponent {\n  static propTypes = {\n    /** Title */\n    title: PropTypes.string,\n    /** Sortable */\n    sortable: PropTypes.bool,\n    /** Max width */\n    maxWidth: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    /** Max height */\n    maxHeight: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    /** Should the legend be expanded by default? */\n    expanded: PropTypes.bool,\n    /** Should the legend be collapsable */\n    collapsable: PropTypes.bool,\n    /** `onChangeOrder = (layerGroupsIds) => {}`\n     * @arg {Array} layerGroupIds The new order\n     */\n    onChangeOrder: PropTypes.func,\n    /** Children for render */\n    children: PropTypes.node,\n  };\n\n  static defaultProps = {\n    title: 'Legend',\n    sortable: true,\n    expanded: true,\n    collapsable: true,\n    maxWidth: null,\n    maxHeight: null,\n    children: [],\n    onChangeOrder: (ids) => console.info(ids),\n  };\n\n  constructor(props) {\n    super(props);\n    const { expanded } = props;\n    this.state = { expanded };\n  }\n\n  /**\n   * UI EVENTS\n   * onToggleLegend\n   * onSortEnd\n   */\n  onToggleLegend = (bool) => {\n    this.setState({ expanded: bool });\n  };\n\n  onSortEnd = ({ oldIndex, newIndex }) => {\n    const { onChangeOrder, children } = this.props;\n    const layers = [...children.map((c) => c.props.layerGroup.dataset)];\n    const layersDatasets = arrayMove(layers, oldIndex, newIndex);\n\n    onChangeOrder(layersDatasets);\n  };\n\n  render() {\n    const { title, sortable, collapsable, maxWidth, maxHeight, children } = this.props;\n\n    const { expanded } = this.state;\n\n    if (!children || !React.Children.count(children)) {\n      return null;\n    }\n\n    return (\n      <div styleName=\"c-legend-map\" style={{ maxWidth }}>\n        {/* LEGEND OPENED */}\n        <div styleName={`open-legend ${classnames({ '-active': expanded })}`} style={{ maxHeight }}>\n          {/* Toggle button */}\n          {collapsable && (\n            <button\n              type=\"button\"\n              styleName=\"toggle-legend\"\n              onClick={() => this.onToggleLegend(false)}\n            >\n              <Icon name=\"icon-arrow-down\" className=\"-small\" />\n            </button>\n          )}\n\n          {expanded && (\n            <LegendList\n              helperClass=\"c-legend-item -sortable\"\n              onSortStart={\n                (_, event) => event.preventDefault() // It fixes user select in Safari and IE\n              }\n              onSortEnd={this.onSortEnd}\n              axis=\"y\"\n              lockAxis=\"y\"\n              lockToContainerEdges\n              lockOffset=\"50%\"\n              useDragHandle\n              sortable={sortable}\n            >\n              {React.Children.map(children, (child, index) =>\n                React.isValidElement(child) && child.type === 'LegendItemList'\n                  ? React.cloneElement(child, { sortable, index })\n                  : child\n              )}\n            </LegendList>\n          )}\n        </div>\n\n        {/* LEGEND CLOSED */}\n        <button\n          type=\"button\"\n          styleName={`close-legend ${classnames({ '-active': !expanded })}`}\n          onClick={() => this.onToggleLegend(true)}\n        >\n          <h1 styleName=\"legend-title\">\n            {title}\n\n            {/* Toggle button */}\n            <div styleName=\"toggle-legend\">\n              <Icon name=\"icon-arrow-up\" className=\"-small\" />\n            </div>\n          </h1>\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default Legend;\nexport { default as LegendListItem } from './components/legend-list-item';\nexport {\n  default as LegendItemToolbar,\n  LegendItemButtonBBox,\n  LegendItemButtonLayers,\n  LegendItemButtonOpacity,\n  LegendItemButtonVisibility,\n  LegendItemButtonInfo,\n  LegendItemButtonRemove,\n} from './components/legend-item-toolbar';\n\nexport {\n  default as LegendItemTypes,\n  LegendItemTypeBasic,\n  LegendItemTypeChoropleth,\n  LegendItemTypeGradient,\n  LegendItemTypeProportional,\n} from './components/legend-item-types';\n\n// export { default as LegendItemTimeline } from './components/legend-item-timeline';\n"],"names":["Legend","props","bool","setState","expanded","oldIndex","newIndex","onChangeOrder","children","layers","map","c","layerGroup","dataset","layersDatasets","arrayMove","state","title","sortable","collapsable","maxWidth","maxHeight","React","Children","count","classnames","onToggleLegend","_","event","preventDefault","onSortEnd","child","index","isValidElement","type","cloneElement","PureComponent","PropTypes","string","oneOfType","number","func","node","ids","console","info"],"mappings":"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"}